<!DOCTYPE html>
<html lang="sv">
    <head>
        <meta charset="UTF-8" />
        <title>Nyhetssida</title>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <style>
            body{
                font-family: sans-serif;
                margin: 0;
                background: #f4f4f4;
            }
            header{ 
                background: black; 
                color: white; 
                text-align: center; padding: 1rem;
            }

            .container{
                width: 30%;
                height: 60%;
                margin: 40px auto;
            }

            .card{
                background: white; 
                border-radius: 5px; 
                box-shadow: 0 2px 6px rgba(0,0,0,0.1);
                padding: 1rem;
                margin-bottom: 1rem;
                cursor: pointer;
                transition: 0.2s;
            }
            .card:hover{
                transform: scale(1.2);
            }

            .sidebar{
                position: fixed;
                top: 0;
                width: 100px;
                height: 100%;
                background: black;
                display: flex;
                color: white;
                justify-content: center;
                text-align: center;
                align-items: center;
            }

            .sidebar.left{
                left: 0;
            }
            .sidebar.right{
                right: 0;
            }

            .modal{
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                display: flex;
                justify-content: center;
                /* z-index: 999; */
            }

            .modal-content{
                background: white;
                padding: 2rem;
                border-radius: 8px;
                max-width: 500px;
                width: 90%;
                position: relative;
            }

            .close-btn{
                position: absolute;
                top: 10px;
                right: 15px;
                font-size: 1.5rem;
                cursor: pointer;
            }

            #app{
                background-color: white;
                display: flex;
                justify-content: center;
            }

        </style>
    </head>

<body>
    
        <header>
            <h1>Nyheter: Drug Overdose Deaths In The US</h1>
        </header>
        <div id="app">

        <div class="container">
            <div class="card" v-for="item in articles" :key="item.id" @click="selectedArticle = item">
                <h3>{{ item.year }} – {{ item.ageGroup }} – {{ item.gender }}</h3>
                <p><strong>Drug type:</strong> {{ item.panel }}</p>
                <!-- <p><strong>Deaths:</strong> {{ item.estimate }} per 100 000 citizen</p>
                <p>{{ item.description }}</p> -->
              </div>
        </div>

        <div class="modal" v-if="selectedArticle" @click.self="selectedArticle = null">
            <div class="modal-content">
                <span class="close-btn" @click="selectedArticle = null">&times;</span>
                <h2>{{ selectedArticle.year }} - {{ selectedArticle.ageGroup }} - {{ selectedArticle.gender }}</h2>
                <p><strong>Drug type:</strong> {{ selectedArticle.panel }}</p>
                <p><strong>Deaths:</strong> {{ selectedArticle.estimate }} per 100 000 citizen</p>
                <p>{{ selectedArticle.description }}</p>
            </div>
        </div>

        <div class="sidebar left">
            <p>hejhej</p>
        </div>

        <div class="sidebar right">
            <p>jehjeh</p>
        </div>
    </div>

<script>
  const {createApp, ref, onMounted} = Vue;

  createApp({
    setup() {
        const selectedArticle = ref(null);
        const articles = ref([]);

        const fetchJson = async () => {
            try {
                const res = await fetch("dataset.json");
                const json = await res.json();
                const data = json.data;
  
                

                const allData = data

                    .map ((row, index) => ({
                        id: index,
                        year: row[17], // år
                        ageGroup: row[15], // åldersgrupp
                        gender: row[16], // kön
                        panel: row[9], // drogtyp
                        estimate: row[21], // ungefära dödsantalet
                        description: `Under ${row[17]} was ${row[21]} deaths per 100 000 reported among ${row[15]?.toLowerCase()} olds.`
                    }));
                
                console.log("Antal artiklar:", allData.length);
                articles.value = allData;


            } catch (err) {
                console.error("Fel vid hämtning:", err);
                
            }           
        };
        
        onMounted(fetchJson);

      return {
        articles,
        selectedArticle
      };
      
    }
  }).mount('#app')
</script>

</body>
</html>